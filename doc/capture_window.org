* caputre window
using CaptureForm captureForm = new CaptureForm(_capture, _windows);
// Make sure the form is hidden after showing, even if an exception occurs, so all errors will be shown
DialogResult result;
try
{
    var mainForm = SimpleServiceProvider.Current.GetInstance<IGreenshotMainForm>();
    result = captureForm.ShowDialog(mainForm);
}
finally
{
    captureForm.Hide();
}

if (result != DialogResult.OK) return;

// The result is the result window.
_selectedCaptureWindow = captureForm.SelectedCaptureWindow;


* links
https://www.withcoder.com/articles/server_side/net/403.html
https://stackoverflow.com/questions/17946380/how-to-add-contextmenu-to-the-system-tray-icon-programmatically
