* key code
#+begin_src cpp
  // CpatureForm
  // called by Timer_Tick
  protected override void Animate()
  {
      lock (_windows)
      {
          foreach (var window in _windows)
          {
              if (!window.Contains(cursorPosition))
              {
                  continue;
              }

              // Only go over the children if we are in window mode
              _selectedCaptureWindow = CaptureMode.Window == _captureMode ? window.FindChildUnderPoint(cursorPosition) : window;
              break;
          }
      }
  }
#+end_src
* caputre window
using CaptureForm captureForm = new CaptureForm(_capture, _windows);
// Make sure the form is hidden after showing, even if an exception occurs, so all errors will be shown
DialogResult result;
try
{
    var mainForm = SimpleServiceProvider.Current.GetInstance<IGreenshotMainForm>();
    result = captureForm.ShowDialog(mainForm);
}
finally
{
    captureForm.Hide();
}

if (result != DialogResult.OK) return;

// The result is the result window.
_selectedCaptureWindow = captureForm.SelectedCaptureWindow;


* links
https://www.withcoder.com/articles/server_side/net/403.html
https://stackoverflow.com/questions/17946380/how-to-add-contextmenu-to-the-system-tray-icon-programmatically
